#????????????????????????
Sys.setlocale("LC_ALL","Chinese")
#excercise 1
x<-c(1,3,2,5)

#experiment 3.6
library(MASS)
library(ISLR)
require(MASS)  #found from website
data(Boston)
fix(Boston)
names(Boston)
attach(Boston) #or use Boston$medv
summary(medv)
dim(Boston)  # find the dimensions of the data frame
#apply the summary to the columns of the data frame 
#'Boston'; the '2' in the apply indicates that 
#'#summary statistics for each column are to be produced 
#'(if this had been set to '1', the summary would have been 
#'applied to each of 506 rows, resulting in a lot(!) of output). 
apply(Boston,2,summary) 
cor(Boston)
lm.fit=lm(medv~lstat)
lm.fit
summary(lm.fit)
names(lm.fit)  #find the list in lm.fit
coef(lm.fit)   # extract coefficients from lm.fit
lm.fit$coefficients #??????????????? ????????????????????????
confint(lm.fit) #????????????????????????confidence interval
predict(lm.fit,data.frame(lstat=(c(5,10,15))),interval="confidence")
predict(lm.fit,data.frame(lstat=(c(5,10,15))),interval="prediction")
#prediction???interval?????????confidence
plot(lstat,medv)
abline(lm.fit,lwd=3,col="red") #abline?????????????????????a?????????b??????,lwd?????????????????????
plot(lstat,medv,pch=1:20) #pch???????????????????????????
par(mfrow=c(2,2)) #????????????
plot(lm.fit) #??????????????????4??? RvsFit
plot(predict(lm.fit),residuals(lm.fit)) #????????????4????????????1
plot(predict(lm.fit),rstudent(lm.fit)) #rstudent-????????????residuals
plot(hatvalues(lm.fit))  #???????????????????????????
which.max(hatvalues(lm.fit))

#_______????????????????????????------------
lm.fit=lm(medv~lstat+age,data=Boston)
summary(lm.fit)
lm.fit=lm(medv~.,data=Boston) #????????????????????????MLR
summary(lm.fit)  
summary(lm.fit)$r.sq   #??????R^2
summary(lm.fit)$sigma  #??????RSE

library(car)
vif(lm.fit) #?????????????????? VIF??????1?????????????????? ??????5??????????????????

lm.fit1=lm(medv~. -age,data=Boston)
summary(lm.fit1)
lm.fit1=update(lm.fit, ~.-age)
summary(lm.fit1)
# interaction??????????????????
summary(lm(medv~lstat*age,data=Boston)) # ??????*???:?????????
summary(lm(medv~lstat+age+lstat:age,data=Boston))

lm.fit2=lm(medv~lstat+I(lstat^2),data=Boston) #I()????????????????????????
summary(lm.fit2)
lm.fit=lm(medv~lstat,data=Boston)
anova(lm.fit,lm.fit2)

lm.fit5=lm(medv~poly(lstat,5),data=Boston)
summary(lm.fit5)

summary(lm(medv~log(rm),data=Boston))
require(ISLR)
data(Carseats)
names(Carseats)
lm.fit=lm(Sales~.+Income:Advertising+Price:Age,data=Carseats) #Income?????????+?????????
summary(lm.fit)
attach(Carseats)
contrasts(ShelveLoc)  #???????????????????????????

#---------???R?????????Function?????????-------------------------
LoadLibraries=function(){
  + library(ISLR)
  + library(MASS)
  +print("The libs have been loaded")
}

LoadLibraries()
